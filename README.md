# dataart-flights
Small service to create/get flight tickets using Spring Boot.

## Requirements

For building and running the application you need:

- [JDK 1.8](http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html)
- [Maven 3](https://maven.apache.org)
- [Docker](https://docs.docker.com/) (for Docker section)

## Technologies
- Kotlin
- Spring Boot
- Spring Data JPA
- H2 database
- Junit 5 with MockK

## Running locally

Using [Spring Boot Maven plugin](https://docs.spring.io/spring-boot/docs/current/reference/html/build-tool-plugins-maven-plugin.html):

```shell
mvn spring-boot:run
```

## Docker

### Build docker image

First it is necessary to compile and package the app to generate the .jar file:
```shell
$ mvn package
```
Then, run this command to build the docker image based on the DockerFile located in the root of the project
```shell
$ docker build -t DOCKER_TAG .
```
Replace DOCKER_TAG with the tag you prefer. For example: **flights:1.0**

### Run docker image
```shell
$ docker run -d -p 8080:8080 -t DOCKER_TAG
```

## Example requests

### Create a Ticket

First launch the Spring Boot application locally (port 8080)

#### Request:
```shell
curl -L -X POST 'http://localhost:8080/tickets' \
-H 'Content-Type: application/json' \
--data-raw '{
	"departureDate": "2020-04-13T09:00:00.00-03:00",
	"arrivalDate": "2020-04-13T18:00:00.00-04:00",
	"cityOfOrigin": "Buenos Aires",
	"destinationCity": "New York",
	"passengerName": "Matias Ficarrotti",
	"passengerAge": 26,
	"luggageStorage": false,
	"price": 1500
}'
```

#### Response:
```json
{
    "id": 1,
    "departureDate": "2020-04-13T09:00:00-03:00",
    "arrivalDate": "2020-04-13T19:00:00-03:00",
    "cityOfOrigin": "Buenos Aires",
    "destinationCity": "New York",
    "passengerName": "Matias Ficarrotti",
    "passengerAge": 26,
    "luggageStorage": false,
    "price": 1500.00
}
```

**NOTE:** The id is autogenerated by the application. The service has timezone support in case the departure/arrival dates have different timezones.

### Get an existing Ticket

#### Request:
```shell
curl -L -X GET 'http://localhost:8080/tickets/1'
```

#### Response:
```json
{
    "id": 1,
    "departureDate": "2020-04-13T09:00:00-03:00",
    "arrivalDate": "2020-04-13T19:00:00-03:00",
    "cityOfOrigin": "Buenos Aires",
    "destinationCity": "New York",
    "passengerName": "Matias Ficarrotti",
    "passengerAge": 26,
    "luggageStorage": false,
    "price": 1500.00
}
```

### Get a non existing Ticket


```shell
curl -L -X GET 'http://localhost:8080/tickets/2'
```

In this case the service will return a **404 Not Found** because a ticket with id=2 does not exist.